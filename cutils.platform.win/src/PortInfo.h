#pragma once

#include <windows.h>
#include <string>

#include "WordSize.h"
#include "Parity.h"
#include "StopBits.h"
#include "DtrControl.h"
#include "RtsControl.h"

#pragma comment(lib, "OneCore.lib")

namespace CUtils
{

/*******************************************************************************
 *
 ******************************************************************************/
class PortInfo
{
public:
    /**  */
    HANDLE handle;
    /**  */
    DCB params;
    /**  */
    std::string name;
    /**  */
    int32_t timeout;

    /***************************************************************************
     *
     **************************************************************************/
    PortInfo();

    /***************************************************************************
     *
     **************************************************************************/
    explicit PortInfo(const PortInfo &) = delete;
    explicit PortInfo(PortInfo &&) noexcept = delete;
    PortInfo &operator=(const PortInfo &) = delete;
    PortInfo &operator=(PortInfo &&) noexcept = delete;

    /***************************************************************************
     *
     **************************************************************************/
    bool isOpen();

    /***************************************************************************
     *
     **************************************************************************/
    bool close();

    /***************************************************************************
     *
     **************************************************************************/
    void reset();

    /***************************************************************************
     *
     **************************************************************************/
    bool getConfig();

    /***************************************************************************
     *
     **************************************************************************/
    bool setConfig();

    /***************************************************************************
     *
     **************************************************************************/
    bool isBinaryMode();

    /***************************************************************************
     *
     **************************************************************************/
    uint32_t getBaudRate();

    /***************************************************************************
     *
     **************************************************************************/
    WordSize getWordSize();

    /***************************************************************************
     *
     **************************************************************************/
    Parity getParity();

    /***************************************************************************
     *
     **************************************************************************/
    StopBits getStopBits();

    /***************************************************************************
     *
     **************************************************************************/
    bool isCtsEnabled();

    /***************************************************************************
     *
     **************************************************************************/
    bool isDsrEnabled();

    /***************************************************************************
     *
     **************************************************************************/
    DtrControl getDtrControl();

    /***************************************************************************
     *
     **************************************************************************/
    RtsControl getRtsControl();

    /***************************************************************************
     *
     **************************************************************************/
    bool isSwFlowControl(bool isOutput);

    /***************************************************************************
     *
     **************************************************************************/
    void setBinaryMode(bool enabled);

    /***************************************************************************
     *
     **************************************************************************/
    void setBaudRate(uint32_t rate);

    /***************************************************************************
     *
     **************************************************************************/
    void setWordSize(WordSize size);

    /***************************************************************************
     *
     **************************************************************************/
    void setParity(Parity parity);

    /***************************************************************************
     *
     **************************************************************************/
    void setStopBits(StopBits stopBits);

    /***************************************************************************
     *
     **************************************************************************/
    void setCtsEnabled(bool enabled);

    /***************************************************************************
     *
     **************************************************************************/
    void setDsrEnabled(bool enabled);

    /***************************************************************************
     *
     **************************************************************************/
    void setDtrControl(DtrControl control);

    /***************************************************************************
     *
     **************************************************************************/
    void setRtsControl(RtsControl control);

    /***************************************************************************
     *
     **************************************************************************/
    void setSwFlowControl(bool isOutput, bool enabled);
};

} // namespace CUtils
