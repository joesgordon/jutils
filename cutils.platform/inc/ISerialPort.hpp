#pragma once

#include <memory>
#include <string>

#include "SerialConfig.h"

namespace CUtils
{

class ISerialPort
{
public:
    ISerialPort();

    /***************************************************************************
     *
     **************************************************************************/
    virtual ~ISerialPort() = 0;

    /***************************************************************************
     *
     **************************************************************************/
    explicit ISerialPort(const ISerialPort &) = delete;
    explicit ISerialPort(ISerialPort &&) noexcept = delete;
    ISerialPort &operator=(const ISerialPort &) = delete;
    ISerialPort &operator=(ISerialPort &&) noexcept = delete;

    /***************************************************************************
     *
     **************************************************************************/
    virtual bool open(const std::string &device) = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual bool close() = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual bool isOpen() const = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual std::string getDevice() const = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual void setTimeout(int32_t millis) = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual void setConfig(const SerialConfig &config) = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual SerialConfig getConfig() = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual int32_t read(void *buffer, int count) = 0;

    /***************************************************************************
     *
     **************************************************************************/
    virtual int32_t write(const void *buffer, int count) = 0;
};

typedef std::shared_ptr<ISerialPort> ISerialPort_;

} // namespace CUtils
